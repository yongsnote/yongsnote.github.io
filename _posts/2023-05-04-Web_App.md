---
layout: single
title:  "jupyter notebook ë³€í™˜í•˜ê¸°!"
categories: coding
tag: [python, blog, jekyll]
toc: true
author_profile: false
---

<head>
  <style>
    table.dataframe {
      white-space: normal;
      width: 100%;
      height: 240px;
      display: block;
      overflow: auto;
      font-family: Arial, sans-serif;
      font-size: 0.9rem;
      line-height: 20px;
      text-align: center;
      border: 0px !important;
    }

    table.dataframe th {
      text-align: center;
      font-weight: bold;
      padding: 8px;
    }

    table.dataframe td {
      text-align: center;
      padding: 8px;
    }

    table.dataframe tr:hover {
      background: #b8d1f3; 
    }

    .output_prompt {
      overflow: auto;
      font-size: 0.9rem;
      line-height: 1.45;
      border-radius: 0.3rem;
      -webkit-overflow-scrolling: touch;
      padding: 0.8rem;
      margin-top: 0;
      margin-bottom: 15px;
      font: 1rem Consolas, "Liberation Mono", Menlo, Courier, monospace;
      color: $code-text-color;
      border: solid 1px $border-color;
      border-radius: 0.3rem;
      word-break: normal;
      white-space: pre;
    }

  .dataframe tbody tr th:only-of-type {
      vertical-align: middle;
  }

  .dataframe tbody tr th {
      vertical-align: top;
  }

  .dataframe thead th {
      text-align: center !important;
      padding: 8px;
  }

  .page__content p {
      margin: 0 0 0px !important;
  }

  .page__content p > strong {
    font-size: 0.8rem !important;
  }

  </style>
</head>


# ML Modelì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ ì›¹ì—¡ì„ ë§Œë“¤ì–´ë´…ì‹œë‹¤.


ë°°ìš¸ ê²ƒ

- í›ˆë ¨ëœ ëª¨ë¸ì„ 'pickle'í•˜ëŠ” ë°©ë²•

- Flask ì•±ì—ì„œ ê·¸ ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•



ë°ì´í„° ì •ë¦¬ì™€ ëª¨ë¸ í›ˆë ¨ì€ ê³„ì†í•  ê²ƒì´ì§€ë§Œ ëª¨ë¸ì„ 'ìƒìœ¼ë¡œ' ì‚¬ìš©í•˜ëŠ” ê²ƒì„ íƒêµ¬í•˜ì—¬ ì›¹ ì•±ì„ êµ¬ì¶•í•´ì•¼ í•©ë‹ˆë‹¤.



ì´ë¥¼ ìœ„í•´ Flaskë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹ ì•±ì„ ë¹Œë“œí•´ì•¼ í•©ë‹ˆë‹¤.











#### appì„ êµ¬í˜„í•˜ê¸°


ê¸°ê³„ í•™ìŠµ ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ì›¹ ì•±ì„ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤. ì›¹ ì•„í‚¤í…ì²˜ì— ë”°ë¼ ëª¨ë¸ í›ˆë ¨ ë°©ë²•ë„ ì˜í–¥ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°ì´í„° ê³¼í•™ ê·¸ë£¹ì—ì„œ í›ˆë ¨í•œ ëª¨ë¸ì„ ì•±ì—ì„œ ì‚¬ìš©í•˜ë„ë¡ ìš”ì²­ë°›ì•˜ë‹¤ê³  ìƒìƒí•´ ë³´ê² ìŠµë‹ˆë‹¤.



ê³ ë ¤ ì‚¬í•­



- ì›¹ ì•±ì¸ê°€, ëª¨ë°”ì¼ ì•±ì¸ê°€? ëª¨ë°”ì¼ ì•±ì„ ê°œë°œí•˜ê±°ë‚˜ IoT í™˜ê²½ì—ì„œ ëª¨ë¸ì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ê²½ìš° TensorFlow Liteë¥¼ ì‚¬ìš©í•˜ì—¬ Android ë˜ëŠ” iOS ì•±ì—ì„œ ëª¨ë¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ëª¨ë¸ì´ ì–´ë””ì— ì €ì¥ë  ê²ƒì¸ê°€? í´ë¼ìš°ë“œ ë˜ëŠ” ë¡œì»¬ì— ì €ì¥í•  ê²ƒì¸ê°€?

- ì˜¤í”„ë¼ì¸ ì§€ì›. ì•±ì€ ì˜¤í”„ë¼ì¸ì—ì„œë„ ì‘ë™í•´ì•¼ í•˜ëŠ”ê°€?

- ì–´ë–¤ ê¸°ìˆ ì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ í›ˆë ¨í–ˆëŠ”ê°€? ì„ íƒí•œ ê¸°ìˆ ì€ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ë„êµ¬ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  - TensorFlow ì‚¬ìš©. TensorFlowë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ í›ˆë ¨í•˜ëŠ” ê²½ìš° TensorFlow ìƒíƒœê³„ëŠ” TensorFlow.jsë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹ ì•±ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” TensorFlow ëª¨ë¸ì„ ë³€í™˜í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

  - PyTorch ì‚¬ìš©. PyTorchì™€ ê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ êµ¬ì¶•í•˜ëŠ” ê²½ìš°, ONNX(Open Neural Network Exchange) í˜•ì‹ìœ¼ë¡œ ë‚´ë³´ë‚´ JavaScript ì›¹ ì•±ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” Onnx Runtimeì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ì˜µì…˜ì€ Scikit-learnìœ¼ë¡œ í›ˆë ¨ëœ ëª¨ë¸ì— ëŒ€í•´ í–¥í›„ ë ˆìŠ¨ì—ì„œ íƒêµ¬ë©ë‹ˆë‹¤.

  - Lobe.ai ë˜ëŠ” Azure Custom Vision ì‚¬ìš©. Lobe.aië‚˜ Azure Custom Visionê³¼ ê°™ì€ ML SaaS(ì†Œí”„íŠ¸ì›¨ì–´ ì„œë¹„ìŠ¤) ì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, ì´ëŸ¬í•œ ì†Œí”„íŠ¸ì›¨ì–´ ìœ í˜•ì€ í´ë¼ìš°ë“œì—ì„œ ì¿¼ë¦¬í•  ìˆ˜ ìˆëŠ” ë§ì¶¤í˜• APIë¥¼ êµ¬ì¶•í•˜ëŠ” ê²ƒì„ í¬í•¨í•˜ì—¬ ë‹¤ì–‘í•œ í”Œë«í¼ì„ ìœ„í•´ ëª¨ë¸ì„ ë‚´ë³´ë‚´ëŠ” ë°©ë²•ì„ ì œê³µí•©ë‹ˆë‹¤.

  

ë˜í•œ ì „ì²´ Flask ì›¹ ì•±ì„ êµ¬ì¶•í•˜ì—¬ ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ëª¨ë¸ì„ ì§ì ‘ í›ˆë ¨í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì´ê²ƒë„ JavaScript ì»¨í…ìŠ¤íŠ¸ì—ì„œ TensorFlow.jsë¥¼ ì‚¬ìš©í•˜ì—¬ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.



ìš°ë¦¬ì˜ ê²½ìš°, Python ê¸°ë°˜ì˜ ë…¸íŠ¸ë¶ì„ ì‚¬ìš©í•´ ì™”ê¸° ë•Œë¬¸ì—, ì´ëŸ¬í•œ ë…¸íŠ¸ë¶ì—ì„œ í›ˆë ¨ëœ ëª¨ë¸ì„ Pythonìœ¼ë¡œ êµ¬ì¶•ëœ ì›¹ ì•±ì—ì„œ ì½ì„ ìˆ˜ ìˆëŠ” í˜•ì‹ìœ¼ë¡œ ë‚´ë³´ë‚´ëŠ” ë°©ë²•ì„ íƒìƒ‰í•´ ë³´ê² ìŠµë‹ˆë‹¤.


#### Exercise - clean your data(ë°ì´í„° ì •í™” ì‘ì—…)


 NUFORC(êµ­ë¦½UFOë³´ê³ ì„¼í„°)ì—ì„œ ìˆ˜ì§‘í•œ 80,000ê±´ì˜ UFO ëª©ê²© ë³´ê³  ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ ë°ì´í„°ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í¥ë¯¸ë¡œìš´ UFO ëª©ê²© ë³´ê³  ì„¤ëª…ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.



- ê¸´ ì˜ˆì‹œ ì„¤ëª…: "ë°¤ì— í’€ë°­ì— ë¹„ì¹˜ëŠ” ê´‘ì„ ì—ì„œ í•œ ë‚¨ìê°€ ë‚˜ì™€ í…ì‚¬ìŠ¤ ì¸ìŠ¤íŠ¸ë£¨ë¨¼íŠ¸ ì£¼ì°¨ì¥ìœ¼ë¡œ ë‹¬ë ¤ê°‘ë‹ˆë‹¤."

ì§§ì€ ì˜ˆì‹œ ì„¤ëª…: "ë¹›ì´ ìš°ë¦¬ë¥¼ ì«“ì•˜ë‹¤."



- ufos.csv ìŠ¤í”„ë ˆë“œì‹œíŠ¸ëŠ” ëª©ê²©ì´ ë°œìƒí•œ ë„ì‹œ, ì£¼ ë° êµ­ê°€, ë¬¼ì²´ì˜ ëª¨ì–‘ ë° ìœ„ë„ ë° ê²½ë„ì— ëŒ€í•œ ì—´ì„ í¬í•¨í•©ë‹ˆë‹¤.



1. ë¹ˆ ë…¸íŠ¸ë¶ì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ pandas, matplotlib ë° numpyë¥¼ ê°€ì ¸ì˜¤ê³  ufos ìŠ¤í”„ë ˆë“œì‹œíŠ¸ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.



```python
import pandas as pd
import numpy as np

ufos = pd.read_csv('/content/ufos.csv')
ufos.head()
```

<pre>
           datetime                  city state country     shape  \
0  10/10/1949 20:30            san marcos    tx      us  cylinder   
1  10/10/1949 21:00          lackland afb    tx     NaN     light   
2  10/10/1955 17:00  chester (uk/england)   NaN      gb    circle   
3  10/10/1956 21:00                  edna    tx      us    circle   
4  10/10/1960 20:00               kaneohe    hi      us     light   

   duration (seconds) duration (hours/min)  \
0              2700.0           45 minutes   
1              7200.0              1-2 hrs   
2                20.0           20 seconds   
3                20.0             1/2 hour   
4               900.0           15 minutes   

                                            comments date posted   latitude  \
0  This event took place in early fall around 194...   4/27/2004  29.883056   
1  1949 Lackland AFB&#44 TX.  Lights racing acros...  12/16/2005  29.384210   
2  Green/Orange circular disc over Chester&#44 En...   1/21/2008  53.200000   
3  My older brother and twin sister were leaving ...   1/17/2004  28.978333   
4  AS a Marine 1st Lt. flying an FJ4B fighter/att...   1/22/2004  21.418056   

    longitude  
0  -97.941111  
1  -98.581082  
2   -2.916667  
3  -96.645833  
4 -157.803611  
</pre>
2. ë°ì´í„°ë¥¼ ìƒˆë¡œìš´ ì œëª©ì„ ê°–ëŠ” ì‘ì€ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜í•˜ê³ , Country ì—´ì˜ ê³ ìœ í•œ ê°’ì„ í™•ì¸.



```python
ufos = pd.DataFrame({'Seconds': ufos['duration (seconds)'], 'Country': ufos['country'],'Latitude': ufos['latitude'],'Longitude': ufos['longitude']})

ufos.Country.unique()
```

<pre>
array(['us', 'ca', 'au', 'gb'], dtype=object)
</pre>
3. null ê°’ì´ ìˆëŠ” ë°ì´í„°ë¥¼ ì‚­ì œí•˜ê³  1-60ì´ˆ ì‚¬ì´ì˜ ëª©ê²© ë³´ê³ ë§Œ ê°€ì ¸ì™€ì„œ ë‹¤ë£¨ì–´ì•¼ í•  ë°ì´í„° ì–‘ì„ ì¤„ì„



```python
ufos.dropna(inplace=True)

ufos = ufos[(ufos['Seconds'] >= 1) & (ufos['Seconds'] <= 60)]

ufos.info()
```

<pre>
<class 'pandas.core.frame.DataFrame'>
Int64Index: 24194 entries, 3 to 80330
Data columns (total 4 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   Seconds    24194 non-null  float64
 1   Country    24194 non-null  object 
 2   Latitude   24194 non-null  float64
 3   Longitude  24194 non-null  float64
dtypes: float64(3), object(1)
memory usage: 945.1+ KB
</pre>
4. Scikit-learnì˜ LabelEncoder ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°€ì ¸ì™€ì„œ êµ­ê°€ì˜ í…ìŠ¤íŠ¸ ê°’ì„ ìˆ«ìë¡œ ë³€í™˜



```python
from sklearn.preprocessing import LabelEncoder

ufos['Country'] = LabelEncoder().fit_transform(ufos['Country'])

ufos.head()
```

<pre>
    Seconds  Country   Latitude   Longitude
3      20.0        3  28.978333  -96.645833
14     30.0        3  35.823889  -80.253611
23     60.0        3  45.582778 -122.352222
25     30.0        3  29.423889  -98.493333
26     30.0        3  38.254167  -85.759444
</pre>
#### build your model



ì´ì œ ë°ì´í„°ë¥¼ í•™ìŠµ ë° í…ŒìŠ¤íŠ¸ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ëª¨ë¸ì„ í•™ìŠµí•  ì¤€ë¹„ë¥¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.



1. Seconds, Latitude ë° Longitudeì„ ì…ë ¥í•˜ë©´ êµ­ê°€ IDë¥¼ ë°˜í™˜í•  ìˆ˜ ìˆë„ë¡ í•˜ë ¤ë©´ X ë²¡í„°ë¡œ ì‚¬ìš©í•  ì„¸ ê°€ì§€ ê¸°ëŠ¥ì„ ì„ íƒí•˜ê³  y ë²¡í„°ëŠ” Countryê°€ ë©ë‹ˆë‹¤.



```python
from sklearn.model_selection import train_test_split

Selected_features = ['Seconds','Latitude','Longitude']

X = ufos[Selected_features]
y = ufos['Country']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)
```

2. ë¡œì§€ìŠ¤í‹± íšŒê·€ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ í›ˆë ¨



```python
from sklearn.metrics import accuracy_score, classification_report
from sklearn.linear_model import LogisticRegression
model = LogisticRegression()
model.fit(X_train, y_train)
predictions = model.predict(X_test)

print(classification_report(y_test, predictions))
print('Predicted labels: ', predictions)
print('Accuracy: ', accuracy_score(y_test, predictions))
```

<pre>
              precision    recall  f1-score   support

           0       1.00      1.00      1.00         1
           1       0.77      0.40      0.53       243
           2       0.00      0.00      0.00         1
           3       0.97      0.99      0.98      4594

    accuracy                           0.96      4839
   macro avg       0.68      0.60      0.63      4839
weighted avg       0.96      0.96      0.96      4839

Predicted labels:  [3 3 3 ... 3 3 3]
Accuracy:  0.9638355032031412
</pre>
<pre>
/usr/local/lib/python3.10/dist-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py:1344: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</pre>
ì •í™•ë„ê°€ ë‚˜ì˜ì§€ ì•ŠìŠµë‹ˆë‹¤(ì•½ 95%), ê·¸ ì´ìœ ëŠ” êµ­ê°€ì™€ ìœ„ë„/ê²½ë„ê°€ ìƒê´€ ê´€ê³„ê°€ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.



ìš°ë¦¬ê°€ ë§Œë“  ëª¨ë¸ì€ ìœ„ë„ ë° ê²½ë„ì—ì„œ êµ­ê°€ë¥¼ ì¶”ë¡ í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë¯€ë¡œ í˜ì‹ ì ì´ì§€ëŠ” ì•Šì§€ë§Œ, ì •ì œí•˜ê³  ë‚´ë³´ë‚´ê³  ì´ ëª¨ë¸ì„ ì›¹ ì•±ì—ì„œ ì‚¬ìš©í•´ë³´ëŠ” ê²ƒì€ ì¢‹ì€ ì—°ìŠµì…ë‹ˆë‹¤


#### picle your model


ì´ì œ ëª¨ë¸ì„ Pickle íŒŒì¼ë¡œ ì €ì¥í•  ì°¨ë¡€ì…ë‹ˆë‹¤. ëª‡ ì¤„ì˜ ì½”ë“œë¡œ ì´ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Pickle íŒŒì¼ë¡œ ì €ì¥ëœ ëª¨ë¸ì„ ë¡œë“œí•˜ê³ , ì´ˆ, ìœ„ë„ ë° ê²½ë„ ê°’ì´ í¬í•¨ëœ ìƒ˜í”Œ ë°ì´í„° ë°°ì—´ì„ ì‚¬ìš©í•˜ì—¬ í…ŒìŠ¤íŠ¸í•´ë³´ì„¸ìš”.



```python
import pickle
model_filename = 'ufo-model.pkl'
pickle.dump(model, open(model_filename,'wb'))

model = pickle.load(open('ufo-model.pkl','rb'))
print(model.predict([[50,44,-12]]))
```

<pre>
[1]
</pre>
<pre>
/usr/local/lib/python3.10/dist-packages/sklearn/base.py:439: UserWarning: X does not have valid feature names, but LogisticRegression was fitted with feature names
  warnings.warn(
</pre>
#### build a Flask app


ì´ì œ ëª¨ë¸ì„ í˜¸ì¶œí•˜ê³  ìœ ì‚¬í•œ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ” Flask ì•±ì„ ë§Œë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤. 

1. ì´ë¥¼ ìœ„í•´ ufo-model.pkl íŒŒì¼ì´ ìˆëŠ” notebook.ipynb íŒŒì¼ ì˜†ì— web-app í´ë”ë¥¼ ë§Œë“¤ì–´ ì£¼ì„¸ìš”.



2. ê·¸ í´ë” ì•ˆì— static í´ë”ë¥¼ ë§Œë“¤ê³  ê·¸ ì•ˆì— css í´ë”ë¥¼ ë§Œë“¤ì–´ ì£¼ì„¸ìš”. ê·¸ë¦¬ê³  templates í´ë”ë¥¼ ë§Œë“¤ì–´ì£¼ì„¸ìš”. ì´ì œ ë‹¤ìŒê³¼ ê°™ì€ íŒŒì¼ê³¼ ë””ë ‰í† ë¦¬ê°€ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.







```

web-app/

  static/

    css/

  templates/

notebook.ipynb

ufo-model.pkl

```



3. web-app í´ë” ì•ˆì— ë¨¼ì € requirements.txt íŒŒì¼ì„ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤. JavaScript ì•±ì—ì„œì˜ package.jsonê³¼ ë¹„ìŠ·í•œ ì—­í• ì„ í•˜ëŠ” ì´ íŒŒì¼ì—ëŠ” ì•±ì—ì„œ í•„ìš”í•œ ì˜ì¡´ì„±ì„ ë‚˜ì—´í•©ë‹ˆë‹¤. requirements.txt íŒŒì¼ ì•ˆì— ë‹¤ìŒê³¼ ê°™ì€ ë¼ì¸ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”





```

scikit-learn

pandas

numpy

flask

```





4. 

ì´ì œ ì›¹ ì•± í´ë”ë¡œ ì´ë™í•˜ì—¬ í•´ë‹¹ íŒŒì¼ì„ ì‹¤í–‰í•˜ë©´ ë©ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ë©´ ë©ë‹ˆë‹¤:



```python
cd /web-app
```

<pre>
/web-app
</pre>
5. í„°ë¯¸ë„ì—ì„œ requirements.txt íŒŒì¼ ì•ˆì— ê¸°ìˆ ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì„ ì„¤ì¹˜í•˜ë ¤ë©´, ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”:



```python
pip install -r requirements.txt
```

<pre>
Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Requirement already satisfied: scikit-learn in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 1)) (1.2.2)
Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 2)) (1.5.3)
Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 3)) (1.22.4)
Requirement already satisfied: flask in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 4)) (2.2.4)
Requirement already satisfied: scipy>=1.3.2 in /usr/local/lib/python3.10/dist-packages (from scikit-learn->-r requirements.txt (line 1)) (1.10.1)
Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn->-r requirements.txt (line 1)) (3.1.0)
Requirement already satisfied: joblib>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-learn->-r requirements.txt (line 1)) (1.2.0)
Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->-r requirements.txt (line 2)) (2022.7.1)
Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas->-r requirements.txt (line 2)) (2.8.2)
Requirement already satisfied: Werkzeug>=2.2.2 in /usr/local/lib/python3.10/dist-packages (from flask->-r requirements.txt (line 4)) (2.3.0)
Requirement already satisfied: itsdangerous>=2.0 in /usr/local/lib/python3.10/dist-packages (from flask->-r requirements.txt (line 4)) (2.1.2)
Requirement already satisfied: click>=8.0 in /usr/local/lib/python3.10/dist-packages (from flask->-r requirements.txt (line 4)) (8.1.3)
Requirement already satisfied: Jinja2>=3.0 in /usr/local/lib/python3.10/dist-packages (from flask->-r requirements.txt (line 4)) (3.1.2)
Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from Jinja2>=3.0->flask->-r requirements.txt (line 4)) (2.1.2)
Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.1->pandas->-r requirements.txt (line 2)) (1.16.0)
</pre>
6. ì´ì œ ì•±ì„ ì™„ì„±í•˜ê¸° ìœ„í•´ ì„¸ ê°œì˜ íŒŒì¼ì„ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤:

- root ë””ë ‰í† ë¦¬ì— app.py íŒŒì¼ ì¶”ê°€

- index.html íŒŒì¼ì„ templates ë””ë ‰í† ë¦¬ì— ì¶”ê°€

- styles.css íŒŒì¼ì„ static/css ë””ë ‰í† ë¦¬ì— ì¶”ê°€ê°€


7. styles.cssì— ëª‡ëª‡ ìŠ¤íƒ€ì¼ì„ ì¶”ê°€





```

body {

	width: 100%;

	height: 100%;

	font-family: 'Helvetica';

	background: black;

	color: #fff;

	text-align: center;

	letter-spacing: 1.4px;

	font-size: 30px;

}



input {

	min-width: 150px;

}



.grid {

	width: 300px;

	border: 1px solid #2d2d2d;

	display: grid;

	justify-content: center;

	margin: 20px auto;

}



.box {

	color: #fff;

	background: #2d2d2d;

	padding: 12px;

	display: inline-block;

}

```





8. index.html íŒŒì¼ ìˆ˜ì •





```

<!DOCTYPE html>

<html>

  <head>

    <meta charset="UTF-8">

    <title>ğŸ›¸ UFO Appearance Prediction! ğŸ‘½</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">

  </head>



  <body>

    <div class="grid">



      <div class="box">



        <p>According to the number of seconds, latitude and longitude, which country is likely to have reported seeing a UFO?</p>



        <form action="{{ url_for('predict')}}" method="post">

          <input type="number" name="seconds" placeholder="Seconds" required="required" min="0" max="60" />

          <input type="text" name="latitude" placeholder="Latitude" required="required" />

          <input type="text" name="longitude" placeholder="Longitude" required="required" />

          <button type="submit" class="btn">Predict country where the UFO is seen</button>

        </form>



        <p>{{ prediction_text }}</p>



      </div>



    </div>



  </body>

</html>

```





index.html íŒŒì¼ì—ì„œ ë³¼ ìˆ˜ ìˆëŠ” ê²ƒì²˜ëŸ¼, {{}}ì™€ ê°™ì€ "mustache" ë¬¸ë²•ìœ¼ë¡œ ì•±ì—ì„œ ì œê³µë  ë³€ìˆ˜ë¥¼ ê°ìŒ‰ë‹ˆë‹¤. ë˜í•œ /predict ê²½ë¡œë¡œ ì˜ˆì¸¡ì„ ê²Œì‹œí•˜ëŠ” í¼ë„ ìˆìŠµë‹ˆë‹¤.



ë§ˆì§€ë§‰ìœ¼ë¡œ, ëª¨ë¸ì„ ì‚¬ìš©í•˜ê³  ì˜ˆì¸¡ ê²°ê³¼ë¥¼ í‘œì‹œí•˜ëŠ” íŒŒì´ì¬ íŒŒì¼ì„ ì‘ì„±í•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.



```python
import numpy as np
from flask import Flask, request, render_template
import pickle

app = Flask(__name__)

model = pickle.load(open("/web-app/static/css/templates/ufo-model.pkl", "rb"))


@app.route("/")
def home():
    return render_template("index.html")


@app.route("/predict", methods=["POST"])
def predict():

    int_features = [int(x) for x in request.form.values()]
    final_features = [np.array(int_features)]
    prediction = model.predict(final_features)

    output = prediction[0]

    countries = ["Australia", "Canada", "Germany", "UK", "US"]

    return render_template(
        "index.html", prediction_text="Likely country: {}".format(countries[output])
    )


if __name__ == "__main__":
    app.run(debug=True)
```

<pre>
 * Serving Flask app '__main__'
 * Debug mode: on
</pre>
<pre>
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug: * Restarting with stat
</pre>
app.py íŒŒì¼ì˜ êµ¬ì„±ì„ ì‚´í´ë³´ì„¸ìš”.



1. ì²«ì§¸, í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¶ˆëŸ¬ì˜¤ê³  ì•±ì„ ì‹œì‘í•©ë‹ˆë‹¤.

2. ê·¸ ë‹¤ìŒ ëª¨ë¸ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.

3. ê·¸ë¦¬ê³  home ë¼ìš°íŠ¸ì—ì„œ index.htmlì„ ë Œë”ë§í•©ë‹ˆë‹¤.

/predict ë¼ìš°íŠ¸ì—ì„œëŠ” í¼ì´ ê²Œì‹œë  ë•Œ ë‹¤ìŒê³¼ ê°™ì€ ì¼ì´ ë°œìƒí•©ë‹ˆë‹¤.



- í¼ ë³€ìˆ˜ê°€ ìˆ˜ì§‘ë˜ê³  numpy ë°°ì—´ë¡œ ë³€í™˜ë©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ëª¨ë¸ë¡œ ì „ì†¡ë˜ì–´ ì˜ˆì¸¡ê°’ì´ ë°˜í™˜ë©ë‹ˆë‹¤.

- í‘œì‹œí•  ë‚˜ë¼ë“¤ì€ ì˜ˆì¸¡ëœ êµ­ê°€ ì½”ë“œë¡œë¶€í„° ì½ê¸° ì‰¬ìš´ í…ìŠ¤íŠ¸ë¡œ ë‹¤ì‹œ ë Œë”ë§ë˜ê³ , ì´ ê°’ì€ index.htmlë¡œ ë‹¤ì‹œ ë³´ë‚´ì ¸ í…œí”Œë¦¿ì—ì„œ ë Œë”ë§ë©ë‹ˆë‹¤.

Flaskì™€ pickled ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì´ë ‡ê²Œ ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ìƒëŒ€ì ìœ¼ë¡œ ê°„ë‹¨í•©ë‹ˆë‹¤. ê°€ì¥ ì–´ë ¤ìš´ ê²ƒì€ ì˜ˆì¸¡ì„ ì–»ê¸° ìœ„í•´ ëª¨ë¸ì— ì „ì†¡í•´ì•¼í•˜ëŠ” ë°ì´í„°ì˜ í˜•íƒœë¥¼ ì´í•´í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ê²ƒì€ ëª¨ë¸ì´ ì–´ë–»ê²Œ í›ˆë ¨ë˜ì—ˆëŠëƒì— ë”°ë¼ ëª¨ë‘ ë‹¬ë¼ì§‘ë‹ˆë‹¤. ì´ ëª¨ë¸ì€ ì˜ˆì¸¡ì„ ì–»ê¸° ìœ„í•´ ì…ë ¥í•´ì•¼ í•  ì„¸ ê°€ì§€ ë°ì´í„° í¬ì¸íŠ¸ê°€ ìˆìŠµë‹ˆë‹¤.



ì „ë¬¸ì ì¸ í™˜ê²½ì—ì„œëŠ” ëª¨ë¸ì„ í›ˆë ¨ì‹œí‚¤ëŠ” ì‚¬ëŒê³¼ ì›¹ ë˜ëŠ” ëª¨ë°”ì¼ ì•±ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì‚¬ëŒë“¤ ê°„ì— ì¢‹ì€ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ì´ í•„ìš”í•˜ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

